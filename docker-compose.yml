# https://docs.docker.com/reference/compose-file/

version: "3.9"

services:
  discord_bot:
    build:
      context: ./apps/discord_bot
      # We are using multiple build contexts so we can easily copy the modules in /pkg/ into the containers
      # https://www.docker.com/blog/dockerfiles-now-support-multiple-build-contexts/
      additional_contexts:
        root: ./
        pkg: ./pkg
      tags:
        - "saint_sim_discord_bot:latest"
    networks:
      - saint_network
    depends_on:
      - api
  api:
    build:
      context: ./apps/api
      additional_contexts:
        root: ./
        pkg: ./pkg
      tags:
        - "saint_sim_api:latest"
    # Expose port 8080 in container to host machine on port 8000
    #* this is just for development
    ports:
      - 8000:8080
    networks:
      - saint_network

# shared network to allow the containers to communicate
networks:
  saint_network:
